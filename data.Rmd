---
title: "data"
author: "Hanan Ali"
date: "2024-07-06"
output: html_document
---

## Load Packages
Before reading and summarizing the data, some necessary packages must be loaded.

```{r}
library(shiny)
library(httr)
library(jsonlite)
library(dplyr)
library(tibble)  # Load tibble package for tbl_df function

BASE_URL <- "https://www.fueleconomy.gov/ws/rest"

get_makes_by_year <- function(year) {
  get_info <- paste0(BASE_URL, "/vehicle/menu/make?year=", year)
  get_info_text <- content(get_info, as = "text")
  get_info_json <- fromJSON(get_info_text, flatten=TRUE)
  get_info_df <- as.data.frame(get_info_json)
  get_info_tbl <- tbl_df(get_info_df)
  return(get_info_tbl)  # Convert to tbl_df
}
```


```{r}
get_models_by_make <- function(make) {
  url <- paste0(BASE_URL, "/vehicle/menu/model?make=", make)
  response <- GET(url)
  data <- fromJSON(content(response, "text"))
  return(tbl_df(as.data.frame(data$menuItem)))  # Convert to tbl_df
}

get_options_by_make_model_year <- function(make, model, year) {
  url <- paste0(BASE_URL, "/vehicle/menu/options?year=", year, "&make=", make, "&model=", model)
  response <- GET(url)
  data <- fromJSON(content(response, "text"))
  return(tbl_df(as.data.frame(data$menuItem)))  # Convert to tbl_df
}

get_vehicle_by_id <- function(vehicle_id) {
  url <- paste0(BASE_URL, "/vehicle/id/", vehicle_id)
  response <- GET(url)
  data <- fromJSON(content(response, "text"))
  return(tbl_df(as.data.frame(data)))  # Convert to tbl_df
}

get_vehicle_by_ymm <- function(year, make, model) {
  url <- paste0(BASE_URL, "/vehicle/", year, "/", make, "/", model)
  response <- GET(url)
  data <- fromJSON(content(response, "text"))
  return(tbl_df(as.data.frame(data)))  # Convert to tbl_df
}

get_fuel_economy_by_ymm <- function(year, make, model) {
  url <- paste0(BASE_URL, "/ympg/shared/ympgVehicle?", "year=", year, "&make=", make, "&model=", model)
  response <- GET(url)
  data <- fromJSON(content(response, "text"))
  return(tbl_df(as.data.frame(data)))  # Convert to tbl_df
}







```





```{r}
BASE_URL <- "https://www.fueleconomy.gov/ws/rest"
get_info <- httr::GET("https://www.fueleconomy.gov/ws/rest/vehicle/menu/make?year=")
get_info_json <- fromJSON(rawToChar(get_info$content))
get_info_df <- as_tibble(get_info_json$data)
print(colnames(get_info_df))




##why can't the above print colnames like below
URL_team_stats <-
  "https://api.nhle.com/stats/rest/en/team/summary?sort=wins&cayenneExp=seasonId=20232024%20and%20gameTypeId=2"
team_stats_return <- httr::GET(URL_team_stats)
parsed_team_stats <- fromJSON(rawToChar(team_stats_return$content))
team_stats <- as_tibble(parsed_team_stats$data)
team_stats |>
  select(everything())
team_stats |>
  select(teamId, teamFullName, everything())
print(colnames(team_stats))
```

